@using NewBlazorServerPJ.Data
@inject IGameServices GameServices
@page "/gamepage"

<PageTitle>Game List</PageTitle>



<h1 style="margin-bottom:10px">Game  -  List</h1>

<NavLink class="nav-link" href="AddEmployee">
    <span class="oi oi-plus" aria-hidden="true">Add a new game</span>
</NavLink>

<table class="table" style="margin-top:10px">
        <thead>
            <tr>
                <th>Game Name</th>  
                <th>Release Date</th>
                <th style="text-align:center">Action</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var game in gameList)
            {                
                <tr>
                    <td>@game.GameName</td>
                    <td>@game.ReleaseDate?.ToString("dd MMMM yyyy")</td>
                    <td style="text-align:center">
                        <div class="width:150px btn-group" role="group" >
                            <a class="nav-link" href="EditEmployee/@game.Id">
                                <span class="oi oi-pencil" aria-hidden="true"></span>
                            </a>
                           
                            <button class="oi oi-trash" @onclick="@(()=> Delete(game.Id))" aria-hidden="true" style="border:none;background-color:white;color:blue;font-size:17px"></button> 
                        </div>                            
                   </td>
                           
               
                </tr>               
            }
        </tbody>
    </table>



@code {
    private GameModel game = new GameModel();
    private List<GameModel> gameList = new List<GameModel>();   

    protected override async Task OnInitializedAsync()
    {              
        GetAllGameList();
    }
 

    private List<GameModel> GetAllGameList()
    {               
        gameList = GameServices.GetGameList();
        return gameList;
    }

    private void Save()
    {
        GameServices.SaveGame(game);
        game = new GameModel();        
        GetAllGameList();  
    }

    private void Edit(int id)
    {        
        game = gameList.FirstOrDefault(g => g.Id == id);            
    }

    private void Delete(int id)
    {
        GameServices.DeleteGame(id);        
        GetAllGameList();      
    }
}
